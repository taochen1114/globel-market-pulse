---
import BaseLayout from "../../layouts/BaseLayout.astro";
import type { MarketDescription } from "../../data/market_descriptions";
import { marketDescriptions } from "../../data/market_descriptions";

export async function getStaticPaths() {
  return marketDescriptions.map((item) => ({
    params: { slug: item.slug },
    props: { description: item }
  }));
}

const { description } = Astro.props as { description: MarketDescription };
const pageTitle = `${description.name} 指數說明`;
const metaDescription = `${description.name}（${description.symbol}）概覽：${description.composition}`;
const related = marketDescriptions.filter((item) => item.slug !== description.slug);
---

<BaseLayout title={pageTitle} description={metaDescription}>
  <article class="index-detail">
    <a class="back-link" href="/">← 回到全球總覽</a>
    <header class="header">
      <h1>{description.name}</h1>
      <p class="tagline">
        <span class="symbol">{description.symbol}</span>
        <span aria-hidden="true" class="divider">•</span>
        <span class="region">{description.region} 市場指標</span>
      </p>
    </header>

    <section class="highlight">
      <h2>指數特色</h2>
      <p>{description.composition}</p>
    </section>

    <section class="info">
      <h3>代表市場</h3>
      <p>{description.region}</p>
    </section>

    <aside class="related" aria-label="其他指數">
      <h3>探索其他指數</h3>
      <ul>
        {related.map((item) => (
          <li>
            <a href={`/indices/${item.slug}`}>
              <span class="name">{item.name}</span>
              <span class="symbol">{item.symbol}</span>
            </a>
          </li>
        ))}
      </ul>
    </aside>
  </article>
</BaseLayout>

<style>
.index-detail {
  background: rgba(15, 23, 42, 0.75);
  border-radius: 20px;
  padding: 2rem;
  border: 1px solid rgba(148, 163, 184, 0.18);
  backdrop-filter: blur(12px);
  color: #e2e8f0;
  display: flex;
  flex-direction: column;
  gap: 1.75rem;
  max-width: 760px;
  margin: 2rem auto;
}

.back-link {
  align-self: flex-start;
  color: #38bdf8;
  text-decoration: none;
  font-size: 0.95rem;
  transition: color 0.2s ease;
}

.back-link:hover,
.back-link:focus-visible {
  color: #0ea5e9;
  text-decoration: underline;
  outline: none;
}

.header h1 {
  margin: 0;
  font-size: 2rem;
  color: #f8fafc;
}

.tagline {
  margin: 0.75rem 0 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: #94a3b8;
  font-size: 0.95rem;
}

.tagline .symbol {
  font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  color: #cbd5f5;
  font-size: 0.9rem;
}

.tagline .divider {
  color: rgba(148, 163, 184, 0.45);
}

.highlight {
  background: rgba(148, 163, 184, 0.08);
  padding: 1.5rem;
  border-radius: 16px;
  border: 1px solid rgba(148, 163, 184, 0.12);
}

.highlight h2 {
  margin: 0 0 0.75rem;
  font-size: 1.25rem;
  color: #f8fafc;
}

.highlight p {
  margin: 0;
  line-height: 1.7;
  color: #e2e8f0;
}

.info h3 {
  margin: 0 0 0.5rem;
  font-size: 1.1rem;
  color: #f8fafc;
}

.info p {
  margin: 0;
  color: #cbd5f5;
  font-size: 1rem;
}

.related {
  border-top: 1px solid rgba(148, 163, 184, 0.12);
  padding-top: 1.5rem;
}

.related h3 {
  margin: 0 0 0.75rem;
  font-size: 1.1rem;
  color: #f8fafc;
}

.related ul {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  gap: 0.75rem;
}

.related a {
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  padding: 0.85rem 1rem;
  border-radius: 12px;
  text-decoration: none;
  background: rgba(15, 23, 42, 0.6);
  border: 1px solid rgba(148, 163, 184, 0.12);
  transition: border-color 0.2s ease, transform 0.2s ease;
}

.related a:hover,
.related a:focus-visible {
  border-color: #38bdf8;
  transform: translateY(-1px);
  outline: none;
}

.related a .name {
  color: #f8fafc;
  font-weight: 600;
}

.related a .symbol {
  color: #94a3b8;
  font-size: 0.85rem;
  font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

@media (max-width: 768px) {
  .index-detail {
    padding: 1.5rem;
    margin: 1.5rem 0;
  }

  .header h1 {
    font-size: 1.65rem;
  }
}
</style>
